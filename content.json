{"meta":{"title":"New Generation Of Migrant Workers","subtitle":"","description":"","author":"Kuter Liu","url":"http://tecnn.github.io","root":"/"},"pages":[],"posts":[{"title":"Test page","slug":"hello-world","date":"2021-11-26T10:35:21.823Z","updated":"2021-11-26T13:17:51.244Z","comments":true,"path":"2021/11/26/hello-world/","link":"","permalink":"http://tecnn.github.io/2021/11/26/hello-world/","excerpt":"","text":"This is test page！！！","categories":[],"tags":[]},{"title":"Seafile 安装脚本（转载）","slug":"Seafile 安装脚本","date":"2021-11-15T16:00:00.000Z","updated":"2021-11-26T13:15:59.264Z","comments":true,"path":"2021/11/16/Seafile 安装脚本/","link":"","permalink":"http://tecnn.github.io/2021/11/16/Seafile%20%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC/","excerpt":"","text":"安装脚本一键安装脚本可以帮助您在 Ubuntu 18.04/20.04 系统上快速的安装好 Seafile 服务器，并配置好 MariaDB, Memcached, WebDAV, Ngnix 和开机自动启动脚本。 使用步骤安装干净的 Ubuntu 18.04/20.04，并做好镜像 (如果安装失败需要还原到镜像)。 切换成 root 账号 (sudo -i) 获取安装脚本适用于 Seafile 8.0.x 及以上版本 cd /opt wget https://seafile-downloads.oss-cn-shanghai.aliyuncs.com/seafile-server_8.0.7_x86-64.tar.gz 12wget https://raw.githubusercontent.com/haiwen/seafile-server-installer-cn/master/seafile-8.0_ubuntu 运行安装脚本并指定要安装的版本 (例如 8.0.0)12bash seafile-8.0_ubuntu 8.0.7 脚本会让您选择要安装的版本, 按照提示进行选择即可: 如果要安装专业版, 需要先将下载好的专业版的包 seafile-pro-server_8.0.0_x86-64.tar.gz 放到 /opt/ 目录下 如果是安装开源版，安装脚本在执行过程中会检查 /opt目录下是否有指定版本号的安装包，如果存在则会安装此包，否则会从 Seafile 网站下载。所以，为了避免因下载失败而导致安装中断，您可以提前下载好安装包放到/opt/目录下。 该脚本运行完后会在命令行中打印配置信息和管理员账号密码，请仔细阅读。(您也可以查看安装日志/opt/seafile/aio_seafile-server.log)，MySQL 的 root 用户密码存储在 /root/.my.cnf 中；MySQL 的 seafile 用户密码存储在 /opt/seafile.my.cnf 中。 通过 Web UI 对服务器进行配置安装完成后，您需要通过 Web UI 服务器进行基本的配置，以便能正常的从网页端进行文件的上传和下载： 首先在浏览器中输入服务器的地址，并用管理员账号和初始密码登录 点击界面的右上角的头像按钮进入管理员界面 进入设置页面填写正确的服务器对外的 SERVICE_URL 和 FILE_SERVER_ROOT，比如 123SERVICE_URL: http://www.your-domain.comFILE_SERVER_ROOT: http://www.your-domain.com/seafhttp 现在您可以退出管理员界面，并进行基本的测试。关于服务器的配置选项介绍和日常运维可以参考 https://cloud.seafile.com/published/seafile-manual-cn/config/README.md 如果安装脚本出错如果安装脚本出错，您需要重置虚拟机到干净的镜像。 启动关闭服务自动安装脚本会在系统中安装开机自动启动脚本。您也可以使用该脚本来关闭/启动 Seafile 服务，命令如下： 123service seafile-server stopservice seafile-server start 启用HTTPS上传证书到/etc/ssl/下 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970log_format seafileformat &#x27;$http_x_forwarded_for $remote_addr [$time_local] &quot;$request&quot; $status $body_bytes_sent &quot;$http_referer&quot; &quot;$http_user_agent&quot; $upstream_response_time&#x27;;server &#123; listen 80; server_name tecnn.cn; rewrite ^ https://$http_host$request_uri? permanent; server_tokens off;&#125;server &#123; listen 443 ssl http2; ssl_certificate /etc/ssl/www.tecnn.cn.pem; ssl_certificate_key /etc/ssl/www.tecnn.cn.key; server_name tecnn.cn; ssl_session_timeout 5m; ssl_session_cache shared:SSL:5m; ssl_prefer_server_ciphers on; proxy_set_header X-Forwarded-For $remote_addr; # add_header Strict-Transport-Security “max-age=31536000; includeSubDomains”; server_tokens off; location / &#123; proxy_pass http://127.0.0.1:8000; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Host $server_name; proxy_set_header X-Forwarded-Proto $scheme; proxy_read_timeout 1200s; # used for view/edit office file via Office Online Server client_max_body_size 0; access_log /var/log/nginx/seahub.access.log seafileformat; error_log /var/log/nginx/seahub.error.log; &#125; location /seafhttp &#123; rewrite ^/seafhttp(.*)$ $1 break; proxy_pass http://127.0.0.1:8082; client_max_body_size 0; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_connect_timeout 36000s; proxy_read_timeout 36000s; access_log /var/log/nginx/seafhttp.access.log seafileformat; error_log /var/log/nginx/seafhttp.error.log; &#125; location /media &#123; root /opt/seafile/seafile-server-latest/seahub; &#125; location /seafdav &#123; proxy_pass http://127.0.0.1:8080/seafdav; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Host $server_name; proxy_set_header X-Forwarded-Proto $scheme; proxy_read_timeout 1200s; client_max_body_size 0; access_log /var/log/nginx/seafdav.access.log seafileformat; error_log /var/log/nginx/seafdav.error.log; &#125;&#125; UFW 防火墙配置123456789101112131415161718192021222324252627282930313233ufw status ---查看防火墙状态Usage: ufw COMMANDCommands: enable enables the firewall disable disables the firewall default ARG set default policy logging LEVEL set logging to LEVEL allow ARGS add allow rule deny ARGS add deny rule reject ARGS add reject rule limit ARGS add limit rule delete RULE|NUM delete RULE insert NUM RULE insert RULE at NUM route RULE add route RULE route delete RULE|NUM delete route RULE route insert NUM RULE insert route RULE at NUM reload reload firewall reset reset firewall status show firewall status status numbered show firewall status as numbered list of RULES status verbose show verbose firewall status show ARG show firewall report version display version informationApplication profile commands: app list list application profiles app info PROFILE show information on PROFILE app update PROFILE update PROFILE app default ARG set default application policy","categories":[{"name":"Seafil Cloud","slug":"Seafil-Cloud","permalink":"http://tecnn.github.io/categories/Seafil-Cloud/"}],"tags":[{"name":"Seafile","slug":"Seafile","permalink":"http://tecnn.github.io/tags/Seafile/"}],"author":"Kuter Liu"}],"categories":[{"name":"Seafil Cloud","slug":"Seafil-Cloud","permalink":"http://tecnn.github.io/categories/Seafil-Cloud/"}],"tags":[{"name":"Seafile","slug":"Seafile","permalink":"http://tecnn.github.io/tags/Seafile/"}]}